---
sidebar: sidebar 
permalink: task_cluster_expansion_contraction.html 
keywords: cluster, expand, expansion, contract, contraction, six, eight, node deployment workflow, workflow, deployment steps 
summary: 從ONTAP Select 9.15.1 開始，您可以增加或減少現有叢集的大小。 
---
= 在 ESXi 或 KVM 主機上擴展或收縮ONTAP Select集群
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
您可以增加 ESXi 和 KVM 虛擬機器管理程式主機的現有ONTAP Select叢集的叢集大小。對於 KVM 主機，您可以將叢集大小從 6 個節點增加到 8 個節點，或將叢集大小從 8 個節點減少到 6 個節點。對於 ESXi 主機，您可以在 6 到 12 個節點之間以增量增加或減少叢集大小。

ESXi 和 KVM 主機不支援以下叢集擴充和收縮：

* 從一個、兩個或四個節點叢集擴展至六個或八個節點叢集。
* 從六節點或八節點群集收縮為一節點、二節點或四節點群集。


[NOTE]
====
若要將叢集中的節點數變更為叢集擴充或收縮不支援的大小，您需要執行下列任務：

. 使用以下方法部署新的多節點叢集：link:task_cli_deploy_cluster.html["命令列介面"]或者link:task_deploy_cluster.html["網頁使用者介面"]隨附ONTAP Select Deploy 管理實用程式。
. 如果適用，請使用以下方法將資料遷移到新叢集：link:https://docs.netapp.com/us-en/ontap/data-protection/snapmirror-disaster-recovery-concept.html["SnapMirror複製"^] 。


====
您可以使用 CLI、API 或 Web 介面從ONTAP Select Deploy 啟動叢集擴充和收縮過程。



== 硬體和儲存注意事項

以下 KVM 和 ESXi 虛擬機器管理程式主機支援叢集擴充和收縮功能。

[role="tabbed-block"]
====
.ESXi
--
從ONTAP Select 9.15.1 開始，ESXi 虛擬機器管理程式主機支援叢集擴充和縮小。

以下 ESXi 虛擬機器管理程式版本支援叢集擴充和收縮：

* ESXi 9.0
* ESXi 8.0 U3
* ESXi 8.0 U2
* ESXi 8.0 U1
* ESXi 8.0 正式版
* ESXi 7.0 U3
* ESXi 7.0


--
.虛擬機
--
從ONTAP Select 9.17.1 開始，KVM 虛擬機器管理程式主機支援叢集擴充和收縮。

以下 KVM 虛擬機器管理程式版本支援叢集擴充和縮小：

* 紅帽企業 Linux (RHEL) 64 位元版本 10.0、9.6、9.5、9.4、9.3、9.2、9.1、9.0、8.8、8.7 和 8.6
* Rocky Linux 10.0、9.6、9.5、9.4、9.3、9.2、9.1、9.0、8.9、8.8、8.7 和 8.6


[NOTE]
====
在 RHEL 10.0 和 Rocky Linux 10.0 主機上，KVM 虛擬機器管理程式存在軟體 RAID 工作流程限制。更多信息，請參閱以下知識庫文章：

* link:https://kb.netapp.com/on-prem/ontap/ontap-select/Select-Issues/CDEPLOY-4020["CDEPLOY-4020： ONTAP Select Deploy：使用 RHEL 10 和 ROCKY 10 建立叢集 HWR 時出現警告訊息"^]
* link:https://kb.netapp.com/on-prem/ontap/ontap-select/Select-Issues/CDEPLOY-4025["CDEPLOY-4025： ONTAP Select DeployGUI：在執行 RHEL10/Rocky 10 的主機上，叢集建立頁面中 SWR 的儲存池和儲存磁碟不可見"^]


====
--
====


== 擴展集群

使用叢集擴充功能來增加現有 ESXi 或 KVM 叢集的大小。

[role="tabbed-block"]
====
.ESXi
--
您可以按以下增量增加現有 ESXi 叢集的大小：

* 從六個節點到八個、十個或十二個節點
* 從八個節點到十個或十二個節點
* 從十到十二個節點


--
.虛擬機
--
您可以將現有 KVM 叢集的大小從六個節點增加到八個節點。

--
====
.關於此任務
在準備叢集擴充時，新的 ESXi 和 KVM 主機會被加入到清單中，並指派新節點的詳細資訊。在開始叢集擴展程序之前，網路預檢查會驗證所選的內部網路。

.開始之前
* 部署多節點叢集時，您應該熟悉網路連線檢查器。您可以使用以下命令執行網路連線檢查器：link:task_adm_connectivity.html["網頁使用者介面"]或者link:task_cli_connectivity.html["命令列介面"]。
* 驗證您是否擁有新節點的許可證詳細資訊。


.步驟
. 使用管理員帳戶Sign in部署公用程式 Web 使用者介面。
. 選擇頁面頂部的“*Cluster*”選項卡，然後從清單中選擇所需的叢集。
. 在集群詳情頁面，選擇頁面右側的齒輪圖標，然後選擇*展開集群*。
. 導航至 *HA Pair 4* 部分。
. 為第四個 HA 對選擇以下高可用性 (HA) 對配置詳細資訊：
+
** 實例類型
** 節點名稱
** 關聯的虛擬機器管理程式主機
** 節點 IP 位址
** 許可證
** 網路設定
** 儲存配置（RAID 類型和儲存池）


. 選擇“儲存 HA 對”以儲存配置詳細資訊。
. 提供ONTAP憑證，然後選擇*擴展叢集*。
. 選擇“*下一步*”，然後選擇“*運行*”運行網路預檢查。
+
網路預檢查驗證為ONTAP叢集流量選擇的內部網路是否正常運作。

. 選擇「*擴展集群*」開始集群擴展過程，然後在對話方塊中選擇「*確定*」。
+
集群擴展最多可能需要 45 分鐘。

. 監控多步驟叢集擴展過程，以確認叢集擴展成功。
. 請參閱「事件」選項卡，以了解操作進度的定期更新。該頁面會定期自動刷新。


.完成後
link:task_cli_clusters.html["備份ONTAP Select Deploy 配置數據"]。



== 收縮集群

使用群集收縮功能來減少現有 ESXi 或 KVM 群集的大小。

[role="tabbed-block"]
====
.ESXi
--
您可以按以下增量減少現有 ESXi 群集的大小：

* 從十二個節點到十個、八個或六個節點
* 從十個節點到八個或六個節點
* 從八個節點到六個節點


--
.虛擬機
--
您可以將現有叢集的大小從八個節點減少到六個節點。

--
====
.關於此任務
在此過程中，選擇集群中所需的 HA 節點對，為集群收縮做準備。

.步驟
. 使用管理員帳戶Sign in部署公用程式 Web 使用者介面。
. 選擇頁面頂部的“*Cluster*”選項卡，然後從清單中選擇所需的叢集。
. 在集群詳情頁面，選擇頁面右側的齒輪圖標，然後選擇*Contract Cluster*。
. 選擇要刪除的任何 HA 對的 HA 對配置詳細資訊並提供ONTAP憑證，然後選擇 *Contract Cluster*。
+
集群收縮可能需要 30 分鐘。

. 監控多步驟集群收縮過程，確認集群收縮成功。
. 請參閱「事件」選項卡，以了解操作進度的定期更新。該頁面會定期自動刷新。

